var x=document.getElementsByClassName("cfw-param"),formElements=[],formInitial=[];for(i=0;i<x.length;i++){var name=x[i].name;formElements.push(name)}function makeModal(e){document.getElementById("paramsinfo").innerHTML=e+'<br /><div class="modal-footer green darken-2 white-text"> <a href="#!" class="modal-close btn-flat white-text">CLOSE</a>',$("#paramsinfo").modal("open")}function saveConfig(){for(i=0;i<formElements.length;i++){var e=formElements[i],t=GetForm(e),o=null;o="checkbox"===t.type?t.checked:(t.type,t.value),localStorage.setItem(e,o)}makeModal("<br />User preset has been saved to cookies<br /><br />")}function saveInitialConfig(){for(i=0;i<formElements.length;i++){var e=GetForm(formElements[i]),t=null;t="checkbox"===e.type?e.checked:(e.type,e.value),formInitial.push(t)}}function loadInitialConfig(){for(i=0;i<formElements.length;i++){ChangeForm(formElements[i],formInitial[i])}$("select").not(".disabled").formSelect()}function clearConfig(){localStorage.clear(),makeModal("<br />User preset has been cleared<br /><br />")}function loadConfig(){for(loadInitialConfig(),i=0;i<formElements.length;i++){var e=formElements[i];ChangeForm(e,localStorage.getItem(e))}$("select").not(".disabled").formSelect(),reloadTheme()}function exportConfig(){download("params.json",JSON.stringify(localStorage,null,4))}function download(e,t){var o=document.createElement("a");o.setAttribute("href","data:text/json;charset=utf-8,"+encodeURIComponent(t)),o.setAttribute("download",e),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}function handleFileSelectForUserPreset(e){for(var t,o=e.target.files,a=0;t=o[a];a++){var n=new FileReader;n.onload=function(e){return function(){var t=e.result,o=(t.split("\n"),JSON.parse(t));Object.keys(o).forEach(function(e){localStorage.setItem(e,o[e])}),makeModal("<br />User preset has been imported from local file and saved to cookies<br /><br />")}}(n),o[a].type.match("json")||makeModal("<br />Invalid file loaded. Make sure to provide a valid JSON file.<br /><br />"),n.readAsText(t)}}function handleFileSelect(e){for(var t,o=e.target.files,a=0;t=o[a];a++){var n=new FileReader;n.onload=function(e){return function(){var t=e.result,o=(t.split("\n"),JSON.parse(t));Object.keys(o).forEach(function(e){ChangeForm(e,o[e])}),makeModal("<br />Preset has been loaded from local file<br /><br />")}}(n),o[a].type.match("json")||makeModal("<br />Invalid file loaded. Make sure to provide a valid JSON file.<br /><br />"),n.readAsText(t)}}function GetForm(e){return document.getElementsByName(e)[0]}function ChangeForm(e,t){var o=GetForm(e);null!==t&&("checkbox"===o.type?(boolValue="true"===t||1==t||"on"===t,o.checked=boolValue,"patch_all"===e&&handleTheWorld()):"select-one"===o.type?o.value=t:"range"===o.type?(name_out=e+"_output",out=GetForm(name_out),"speed_normal_battery"==e?(o.value=t,handleTheJoules(t)):"speed_normal_phase"==e||"brake_i_min"==e||"brake_i_max"==e?(o.value=t,out.value=t/1e3):(o.value=t,out.value=t)):o.value=t)}function loadPreset(e){switch(loadInitialConfig(),e){case"lothean":updateVoltage(48),loadMine();break;case"rp":updateVoltage(36),loadVoreingestellt();break;case"shmax":updateVoltage(36),loadSHMax();break;default:updateVoltage(36)}$("select").not(".disabled").formSelect(),reloadTheme()}function updateVoltage(e){default_voltage=e,resetCurrent(),handleTheJoules(1e3*default_ampere),36==e?(document.getElementById("voltage").selectedIndex=0,document.getElementById("voltage")[document.getElementById("voltage").selectedIndex].selected=!0):(document.getElementById("voltage").selectedIndex=1,document.getElementById("voltage")[document.getElementById("voltage").selectedIndex].selected=!0)}function loadMine(){ChangeForm("version_spoofing","true"),ChangeForm("speed_normal_kmh","27"),ChangeForm("boot_workmode","2"),ChangeForm("direct_power_control","dyn"),ChangeForm("direct_power_control_curve","quadratic"),ChangeForm("current_raising_coefficient","4500"),ChangeForm("motor_start_speed","2"),ChangeForm("no_kers","true"),ChangeForm("brake_light_mode","reversed"),ChangeForm("brake_light_flash_frequency","253"),ChangeForm("no_cruise_control","true"),ChangeForm("error_raising_level","2"),ChangeForm("no_overspeed_alarm","true"),ChangeForm("speed_normal_battery","28000")}function loadVoreingestellt(){ChangeForm("region","auto"),ChangeForm("brake_light_mode","static")}function loadSHMax(){ChangeForm("speed_normal_battery","35000"),ChangeForm("speed_normal_kmh","45"),ChangeForm("current_raising_coefficient","1500"),ChangeForm("motor_start_speed","2"),ChangeForm("no_kers","true"),ChangeForm("no_overspeed_alarm","true")}document.getElementById("file-selector-b").addEventListener("change",handleFileSelectForUserPreset,!1),document.getElementById("file-selector-a").addEventListener("change",handleFileSelect,!1);